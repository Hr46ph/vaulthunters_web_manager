# VaultHunters Web Manager Configuration
# Copy this file to config.toml and customize the settings for your environment.
# DO NOT commit config.toml to version control - it contains environment-specific settings.

[server]
# Path to your VaultHunters Minecraft server directory
minecraft_server_path = "/home/minecraft/vaulthunters"

# Path to your backup directory 
backup_path = "/home/minecraft/backups"

# Java executable path (use full path if java is not in PATH)
java_executable = "java"

# Server jar filename (should be in your minecraft_server_path)
server_jar = "forge-1.18.2-40.2.21-universal.jar"

# Minecraft server connection details
minecraft_server_host = "localhost"
minecraft_server_port = 25565

[jvm]
# Memory allocation (adjust based on your system)
# Recommended: Use same value for min and max memory for optimal performance
memory_min = "4G"
memory_max = "8G"

# Aikar's JVM optimization flags for VaultHunters
# These flags are specifically optimized for Minecraft servers with high memory allocation rates
# Source: https://docs.papermc.io/paper/aikars-flags/
# 
# Key benefits:
# - Reduces garbage collection pause times
# - Optimizes G1 garbage collector for Minecraft's allocation patterns  
# - Improves server performance and reduces lag spikes
# - Handles VaultHunters' high memory usage efficiently
#
# Note: These flags are tested and recommended for all Minecraft versions (1.8 to 1.20+)
optimization_flags = [
    "+UseG1GC",
    "+ParallelRefProcEnabled", 
    "MaxGCPauseMillis=200",
    "+UnlockExperimentalVMOptions",
    "+DisableExplicitGC",
    "+AlwaysPreTouch",
    "G1NewSizePercent=30",
    "G1MaxNewSizePercent=40", 
    "G1HeapRegionSize=8M",
    "G1ReservePercent=20",
    "G1HeapWastePercent=5",
    "G1MixedGCCountTarget=4",
    "InitiatingHeapOccupancyPercent=15",
    "G1MixedGCLiveThresholdPercent=90",
    "G1RSetUpdatingPauseTimePercent=5",
    "SurvivorRatio=32",
    "+PerfDisableSharedMem",
    "MaxTenuringThreshold=1"
]

# Aikar's flag identification (do not modify)
system_properties = [
    "using.aikars.flags=https://mcflags.emc.gs",
    "aikars.new.flags=true"
]

[web]
# Web interface binding
host = "0.0.0.0"
port = 8080

# Security settings
# IMPORTANT: Change this to a random secret key in production!
secret_key = "change-this-to-a-random-secret-key"

# Debug mode (set to false for production)
debug = false

[security]
# Session settings
session_lifetime_hours = 24
session_cookie_secure = false  # Set to true when using HTTPS
session_cookie_httponly = true
session_cookie_samesite = "Lax"

# CSRF protection
csrf_enabled = true
csrf_time_limit = 3600  # 1 hour

# File upload limits
max_file_size_mb = 16

[logs]
# Log file paths (relative to minecraft_server_path)
server_log = "logs/latest.log"
debug_log = "logs/debug.log" 
crash_reports = "crash-reports"

[files]
# Configuration files that can be edited through the web interface
# (paths relative to minecraft_server_path)
editable_configs = [
    "server.properties",
    "whitelist.json", 
    "banned-players.json",
    "banned-ips.json",
    "ops.json"
]

# Allowed backup file extensions for download
allowed_backup_extensions = [".zip", ".tar.gz", ".tar", ".7z"]

[rate_limiting]
# Rate limits (requests per minute) to prevent abuse
server_control = 5
config_save = 10
backup_download = 3

[metrics]
# Metrics collection and storage settings
# Collection interval in seconds (how often to collect metrics)
collection_interval = 5

# Retention period in days (how long to keep historical data)
retention_days = 7

# Database path (relative to application root)
database_path = "data/metrics.db"

# Enable/disable metrics collection
enabled = true

# Metrics to collect (true/false for each type)
collect_system_memory = true
collect_system_cpu = true
collect_system_load = true
collect_java_process = true
collect_server_tps = true
collect_player_count = true